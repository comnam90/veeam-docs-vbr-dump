---
title: "How Inline Scan Works"
product: "vbr"
doc_type: "userguide"
source_url: "https://helpcenter.veeam.com/docs/vbr/userguide/malware_detection_inline_scan_hiw.html"
last_updated: "2/12/2026"
product_version: "13.0.1.1071"
---

# How Inline Scan Works


For inline scan, malware detection works in the following way:

1. During the backup job, Veeam Backup & Replication analyzes the metadata of data blocks and saves the ransomware index in a temporary folder on the backup proxy. A file in the RIDX format is created for each disk and contains the following information:

* Disk metadata (disk name, creation time, disk size, used size, sector size, partition table)
* Ransomware data for each data block (encrypted data, file types, onion addresses, ransomware notes)

|  |
| --- |
| Note |
| If LZMA headers are found, they will be excluded from encrypted data calculation to decrease the number of false positive events. |

1. When the backup job is complete, the ransomware index is saved on the backup server. By default, the path is %volume%:\VBRCatalog\Index\Machines\%machine\_name%\%date%%guid%\ransomwareidx (for Veeam Backup & Replication on Microsoft Windows) or /var/lib/veeam/catalog/Index/Machines/%machine\_name%/%date%%guid%/ransomwareidx (for Veeam Backup & Replication on Linux). The Veeam Catalog Service notifies the Veeam Data Analyzer Service about new data that needs to be scanned.
2. The Veeam Data Analyzer Service checks the last scan results in the RansomwareIndexAnalyzeState.xml file located in the VBRCatalog folder (for Veeam Backup & Replication on Microsoft Windows) or in the /var/lib/veeam/catalog/ directory (for Veeam Backup & Replication on Linux) and initiates a new inline scan. The scan is also initiated if the Veeam Data Analyzer Service gets new indexing data after the service starts.
3. During the scan, the Veeam Data Analyzer Service compares a new restore point with the earliest one created for the last 25 hours. For example, two restore points were created 10 and 5 hours ago. The new restore point will be compared with the restore point created 10 hours ago.

If the previous restore point was not created for the last 25 hours, the service tries to find the nearest restore point created for the last 30 days. For example, two restore points were created 2 days and 10 days ago. The new restore point will be compared with the restore point created 2 days ago.

1. The Veeam Data Analyzer Service compares the last and previous RIDX files and updates the RansomwareIndexAnalyzeState.xml file. If malware activity is detected, the service will create a malware detection event and mark objects as Suspicious.

If the previous RIDX file is not found, the Veeam Data Analyzer Service will perform a full disk read operation to create a RIDX file. In this case, the job session will last longer than usual but the size of the incremental backup file will not be affected. The first RIDX file will be used as a source for the first scan session and will not be analyzed after creation.

A full disk read operation will also be performed if you add a new disk to the VM.

|  |
| --- |
| Note |
| For VMware vSphere environments, the Changed Block Tracking (CBT) option will not be used. For more information on the option, see [Changed Block Tracking](changed_block_tracking.md). |


