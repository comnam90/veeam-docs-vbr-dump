---
title: "Set-VBRMalwareDetectionOptions"
source_url: "https://helpcenter.veeam.com/docs/vbr/powershell/set-vbrmalwaredetectionoptions.html"
last_updated: "8/1/2025"
product_version: "13.0.1.1071"
---

# Set-VBRMalwareDetectionOptions

In this article

Short Description

Modifies malware detection settings.

Applies to

Product Edition: Standard, Enterprise, Enterprise Plus, Veeam Universal License

Syntax

|  |
| --- |
| Set-VBRMalwareDetectionOptions [-EnableInlineMalwareScan][-Sensitivity <VBRRansomwareScanningSensitivity>] [-EnableQuickBackupOnExternalEvent] [-EnableGuestIndexScan] [-EnableUseIndicatorsOfCompromise] [-UpdateExtensionsListPeriodically][-SuspiciousExtensions <String[]>] [-NonSuspiciousExtensions <String[]>] [-IgnoredPaths <String[]>] [-NotificationOptions <VBRNotificationOptions>] [-StartThreatHunterAfterDetection] [-AutoResolveEventAfterCleanScan] [-DetectionEngine <VBRDetectionEngine>] [-ScanArchives] [<CommonParameters>] |

Detailed Description

This cmdlet modifies malware detection settings.

Parameters

| Parameter | Description | Type | Required | Position | Accept Pipeline Input |
| --- | --- | --- | --- | --- | --- |
| DetectionEngine | Specifies the scan engine:   * External * VeeamThreatHunter   Default: External | [VBRDetectionEngine](enums.md#VBRDetectionEngine) | False | Named | False |
| EnableGuestIndexScan | Enables guest indexing data scan. If you provide this parameter, the cmdlet will scan guest indexing data for the following malware activity:   * Known suspicious files and extensions * Renamed files * Deleted files   Note: You must also enable the guest file indexing option for a job. To do this, run the [Enable-VBRJobGuestFSIndexing](enable-vbrjobguestfsindexing.md) cmdlet.  Default: False. | SwitchParameter | False | Named | False |
| EnableInlineMalwareScan | Enables inline scan. If you provide this parameter, the cmdlet will scan data blocks for the following malware activity:   * Encrypted files * Onion links * Ransom notes   Use the Sensitivity parameter to specify the level of scan sensitivity.  Default: False. | SwitchParameter | False | Named | False |
| EnableQuickBackupOnExternalEvent | Enables a quick backup. If you provide this parameter, the cmdlet will initiate a quick backup of machines when the system gets notification of the infection threat.  Default: False. | SwitchParameter | False | Named | False |
| EnableUseIndicatorsOfCompromise | Enables the indicator of compromise algorithm during guest indexing data scans.  Default: True | SwitchParameter | False | Named | False |
| IgnoredPaths | Defines a path to the trusted file or folder. The cmdlet will not check these files or folders.  This parameter is applied only to guest indexing data scan when detecting known suspicious files and extensions, deleted files, and renamed files. | String[] | False | Named | False |
| NonSuspiciousExtensions | Defines a file mask for trusted file extensions. The cmdlet will not check files with these extensions.  Note: This parameter is applied only to guest indexing data scan when detecting known suspicious files and extensions, deleted files, and renamed files. | String[] | False | Named | False |
| NotificationOptions | Specifies notification options. The cmdlet will set malware detection settings with these notification options. | Accepts the VBRNotificationOptions object. To create this object, run the [New-VBRNotificationOptions](new-vbrnotificationoptions.md) cmdlet. | False | Named | False |
| ScanArchives | Enables scanning of additional archive and compound files, including RAR, ZIP, CHM, and installers.  If this parameter is set to True, the DetectionEngine parameter must be set to VeeamThreatHunter.  Default: False. | SwitchParameter | False | Named | False |
| Sensitivity | Specifies the level of inline scan sensitivity:   * Low * BetweenLowAndNormal * Normal * BetweenNormalAndExtreme * Extreme   Default: Normal. | [VBRRansomwareScanningSensitivity](enums.md#VBRRansomwareScanningSensitivity) | False | Named | False |
| StartThreatHunterAfterDetection | Enables automatic signature-based scans when a malware detection event with the Suspicious status is created after a guest indexing data scan or inline scan. | SwitchParameter | False | Named | False |
| AutoResolveEventAfterCleanScan | For the StartThreatHunterAfterDetection parameter.  Defines if malware detection events are automatically marked as clean when no threats are detected by a proactive or signature-based scan. | SwitchParameter | False | Named | False |
| SuspiciousExtensions | Defines a file mask for suspicious file extensions. The cmdlet will trigger a malware detection event when this type of the file appears in backups. | String[] | False | Named | False |
| UpdateExtensionsListPeriodically | Defines that Veeam Backup & Replication will update a list of suspicious file extensions automatically.  Default: False. | SwitchParameter | False | Named | False |

<CommonParameters>

This cmdlet supports Microsoft PowerShell common parameters. For more information on common parameters, see  [Microsoft Docs](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_commonparameters?view=powershell-7).

Output Object

[VBRMalwareDetectionOptions](vbrmalwaredetectionoptions.md)

Examples

Modifying Malware Detection Settings

This command enables the following malware detection settings:

* Guest indexing data scan for guest OS files and folders.
* Inline scan with the BetweenNormalAndExtreme sensitivity level.

|  |
| --- |
| Set-VBRMalwareDetectionOptions -EnableGuestIndexScan -EnableInlineMalwareScan -Sensitivity BetweenNormalAndExtreme |

Page updated 8/1/2025

Page content applies to build 13.0.1.1071
